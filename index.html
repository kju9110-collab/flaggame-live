<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì„¸ê³„ ê²½ì œ 50ëŒ€êµ­ ì„œë°”ì´ë²Œ</title>
    <style>
        body { margin: 0; background-color: #90D5FF; overflow: hidden; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; }
        .info-panel { margin-top: 15px; display: flex; gap: 15px; z-index: 10; }
        .ui-box { background: white; border: 2px solid black; border-radius: 12px; padding: 8px 20px; text-align: center; min-width: 100px; box-shadow: 2px 2px 0px rgba(0,0,0,0.2); }
        
        #arena-container { position: relative; margin: 40px 0; }
        #arena { width: 320px; height: 320px; border: 8px solid black; border-radius: 50%; background-color: white; position: relative; overflow: visible; }
        #hole { position: absolute; right: -12px; top: 50%; transform: translateY(-50%); width: 20px; height: 60px; background-color: #90D5FF; z-index: 5; }
        
        .flag { position: absolute; width: 30px; height: 20px; background-size: cover; border: 0.5px solid #ccc; z-index: 2; border-radius: 2px; }

        /* í•˜ë‹¨ ìŒ“ì´ëŠ” êµ­ê¸° ì˜ì—­ */
        #flag-list { 
            width: 95%; height: 120px; display: grid; grid-template-columns: repeat(10, 1fr); 
            grid-template-rows: repeat(5, 1fr); gap: 4px; padding: 10px; 
            background: rgba(255,255,255,0.4); border-radius: 10px; border: 2px solid rgba(0,0,0,0.1);
        }
        .list-flag { width: 100%; height: 22px; background-size: cover; border: 0.5px solid #555; border-radius: 2px; animation: popIn 0.3s ease-out; }
        
        @keyframes popIn { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

<div class="info-panel">
    <div class="ui-box"><b>1ë“±(ìš°ìŠ¹)</b><br><span id="winner-name">-</span></div>
    <div class="ui-box"><b>ìƒì¡´ êµ­ê°€</b><br><span id="survivor-count">0</span></div>
</div>

<div id="arena-container">
    <div id="arena"><div id="hole"></div></div>
</div>

<div id="flag-list"></div>

<script>
    const arena = document.getElementById('arena');
    const flagListContainer = document.getElementById('flag-list');
    const winnerDisplay = document.getElementById('winner-name');
    const survivorDisplay = document.getElementById('survivor-count');
    
    const radius = 160;
    let flags = [];
    
    // ğŸŒ ì„¸ê³„ ê²½ì œ ìˆœìœ„ ìƒìœ„ ì•½ 50ê°œêµ­ ì½”ë“œ
    const econ50 = [
        'us','cn','jp','de','in','gb','fr','it','ca','br','ru','kr','au','es','mx','id','nl','sa','tr','ch',
        'tw','pl','se','be','eg','ie','th','no','ar','il','ae','za','dk','my','sg','ph','vn','ro','cz','cl',
        'fi','co','at','hk','pk','hu','pe','gr','nz','dz'
    ];

    function initGame() {
        arena.querySelectorAll('.flag').forEach(el => el.remove());
        flagListContainer.innerHTML = '';
        flags = [];
        winnerDisplay.innerText = "-";

        // 50ê°œêµ­ ì¤‘ ë¬´ì‘ìœ„ë¡œ 20~30ê°œë¥¼ ë½‘ì•„ ê²Œì„ ì§„í–‰ (ë„ˆë¬´ ë§ìœ¼ë©´ ê²¹ì³ì„œ 25ê°œ ì¶”ì²œ)
        const selected = [...econ50].sort(() => Math.random() - 0.5).slice(0, 25);

        selected.forEach((code) => {
            const el = document.createElement('div');
            el.className = 'flag';
            el.style.backgroundImage = `url('https://flagcdn.com/w40/${code}.png')`;
            arena.appendChild(el);

            const angle = Math.random() * Math.PI * 2;
            const speed = 2.5 + Math.random() * 1.5;
            flags.push({ el, code, x: radius, y: radius, vx: Math.cos(angle) * speed, vy: Math.sin(angle) * speed, out: false });
        });
        
        survivorDisplay.innerText = flags.length;
        requestAnimationFrame(update);
    }

    function update() {
        let activeFlags = flags.filter(f => !f.out);
        survivorDisplay.innerText = activeFlags.length;

        activeFlags.forEach(f => {
            f.x += f.vx; f.y += f.vy;
            const dx = f.x - radius, dy = f.y - radius;
            const dist = Math.sqrt(dx * dx + dy * dy);

            // ğŸ”´ êµ¬ë©ìœ¼ë¡œ íƒˆë½ ì‹œ ìˆœì„œëŒ€ë¡œ ì•„ë˜ ìŒ“ê¸°
            if (f.x > radius + 145 && f.y > radius - 30 && f.y < radius + 30) {
                f.out = true;
                f.el.style.display = 'none';
                
                // íƒˆë½í•œ êµ­ê¸°ë¥¼ ì•„ë˜ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
                const listItem = document.createElement('div');
                listItem.className = 'list-flag';
                listItem.style.backgroundImage = f.el.style.backgroundImage;
                flagListContainer.appendChild(listItem);
                
                checkGameOver();
                return;
            }

            if (dist + 15 > radius) {
                const nx = dx / dist, ny = dy / dist;
                const dot = f.vx * nx + f.vy * ny;
                f.vx -= 2 * dot * nx; f.vy -= 2 * dot * ny;
                
                const shift = (Math.random() - 0.5) * 0.4;
                const cos = Math.cos(shift), sin = Math.sin(shift);
                const oldVx = f.vx;
                f.vx = f.vx * cos - f.vy * sin;
                f.vy = oldVx * sin + f.vy * cos;

                f.x = radius + nx * (radius - 15.2);
                f.y = radius + ny * (radius - 15.2);
            }
            f.el.style.left = (f.x - 15) + 'px';
            f.el.style.top = (f.y - 10) + 'px';
        });

        if (flags.filter(f => !f.out).length > 1) {
            requestAnimationFrame(update);
        }
    }

    function checkGameOver() {
        const remaining = flags.filter(f => !f.out);
        if (remaining.length === 1) {
            const winner = remaining[0];
            winnerDisplay.innerText = winner.code.toUpperCase();
            winner.el.style.transform = "scale(2.5)";
            winner.el.style.transition = "transform 0.5s";
            
            // 1ë“± êµ­ê¸°ë„ ë§ˆì§€ë§‰ì— ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
            setTimeout(() => {
                const listItem = document.createElement('div');
                listItem.className = 'list-flag';
                listItem.style.backgroundImage = winner.el.style.backgroundImage;
                listItem.style.border = "2px solid gold"; // ìš°ìŠ¹ì í‘œì‹œ
                flagListContainer.appendChild(listItem);
            }, 500);

            setTimeout(initGame, 4000); // 4ì´ˆ í›„ ë‹¤ìŒ ê²Œì„
        }
    }

    initGame();
</script>
</body>
</html>
